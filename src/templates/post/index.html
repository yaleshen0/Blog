{% extends 'base.html' %}

{% block content %}
    <span class="title">
        {% if current_user.is_authenticated %}
        <h1>
            <span>{% block title %} Welcome to the {{ name }}'s blog {% endblock %}</span>
            <a href="{{ url_for('auth.logout') }}">
                Logout
            </a>
        </h1>
        {% endif %}
    </span>
    <div class="create-post">
        <h2>Add a post
            <a href="{{ url_for('post.create') }}" style="text-decoration:none;">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-plus-square" viewBox="0 0 16 16">
                    <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
                </svg>
            </a>
        </h3> 
    </div>
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="notification is-danger">
                {{ messages[0] }}
            </div>
        {% endif %}
    {% endwith %}
    <div class="content">
        {% if current_user.is_authenticated %}
            {% if posts %}
                {% for post in posts %}
                    <div class='post'>
                        <p>{{ post['created_at'] }}</p>
                        <h2>
                            <a href="{{ url_for('post.get_post', post_id=post['id']) }}">{{ post['title'] }}</a>
                        </h2>
                        <p>{{ post['content'] }}</p>
                        <form action="{{ url_for('post.delete', post_id=post['id']) }}" method="POST">
                            <label for="delete"></label>
                            <input class="delete delete-input" type="submit" value="Delete"
                                onclick="return confirm('Are you sure you want to delete this post?')"
                                />
                        </form>
                    </div>
                    
                {% endfor %}
            {% else %}
                <div class="post">
                    You dont have a post yet + One now
                </div>
            {% endif %}
        {% endif %}
    </div>
{% endblock %}